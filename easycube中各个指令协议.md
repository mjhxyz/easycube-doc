# 指令协议
- [指令协议](#指令协议)
  - [前言](#前言)
  - [手动调节气囊 (1)](#手动调节气囊-1)
    - [请求 (长度3 + 13 = 16)](#请求-长度3--13--16)
    - [响应(长度: 4 = 3 + 1)](#响应长度-4--3--1)
  - [匹配床垫 (2)](#匹配床垫-2)
    - [请求(长度: 3 = 3 + 0)](#请求长度-3--3--0)
    - [响应(长度: 4 = 3 + 1)](#响应长度-4--3--1-1)
  - [同步床垫系统时间(3)](#同步床垫系统时间3)
    - [请求(长度: 3)](#请求长度-3)
    - [响应(长度: 4 = 3 + 1)](#响应长度-4--3--1-2)
  - [获取气囊手动调节设置的气压(4)](#获取气囊手动调节设置的气压4)
    - [请求(长度: 3)](#请求长度-3-1)
    - [响应(长度: 11 = 3 + 8)](#响应长度-11--3--8)

## 前言

- 之前所有的指令都是通过 `json` 进行自描述的, 因此开发起来会更加简单
- 但是考虑到后续通过蓝牙的数据更加的多且更加频繁，`json` 本身携带的用来描述的数据相对来说，非常多。所以需要尽可能的减少单次指令`传输的数据量`
- 因此, 现在部分频繁使用的指令，通过约定的方式的方式来传输二进制数据, 而不再使用 `json` 这种字符串数据
- 尽可能的将一个指令封装在一个 ble 包(`20Bytes`)中, 以减少包的数量

## 手动调节气囊 (1)

### 请求 (长度3 + 13 = 16)

**path(长度: 3)**

`1\n\n`

**data(长度: 13)**

| 字段      | 长度 | 类型 | 描述         |
| --------- | ---- | ---- | ------------ |
| `user_id` | 4    | int  | 用户ID       |
| `la1`     | 1    | int  | 左1气囊      |
| `la2`     | 1    | int  | 左2气囊      |
| `la3`     | 1    | int  | 左3气囊      |
| `la4`     | 1    | int  | 左4气囊      |
| `ra1`     | 1    | int  | 右1气囊      |
| `ra2`     | 1    | int  | 右2气囊      |
| `ra3`     | 1    | int  | 右3气囊      |
| `ra4`     | 1    | int  | 右4气囊      |
| `mask`    | 1    | int  | 气囊调整掩码 |

### 响应(长度: 4 = 3 + 1)

**path(长度: 3)**

`2\n\n`

**data(长度: 1)**

| 字段     | 长度 | 类型 | 描述 |
| -------- | ---- | ---- | ---- |
| `status` | 1    | int  | 空   |

## 匹配床垫 (2)

### 请求(长度: 3 = 3 + 0)

**path(长度: 3)**

`2\n\n`

**data(长度: 0)**

| 字段 | 长度 | 类型 | 描述 |
| ---- | ---- | ---- | ---- |
| `-`  | 0    | void | 空   |

### 响应(长度: 4 = 3 + 1)

**path (长度: 3)**

`2\n\n`

**data (长度: 1)**

| 字段   | 长度 | 类型 | 描述                       |
| ------ | ---- | ---- | -------------------------- |
| `状态` | 1    | int  | 是否匹配成功 1:成功 2:失败 |

## 同步床垫系统时间(3)

### 请求(长度: 3)

**path(长度: 3)**

`3\n\n`

**data (长度: 4)**

| 字段   | 长度 | 类型 | 描述   |
| ------ | ---- | ---- | ------ |
| `time` | 4    | int  | 时间戳 |


### 响应(长度: 4 = 3 + 1)

**path(长度: 3)**

`3\n\n`

**data (长度: 1)**
| 字段     | 长度 | 类型 | 描述 |
| -------- | ---- | ---- | ---- |
| `status` | 1    | int  | 状态 |


## 获取气囊手动调节设置的气压(4)

### 请求(长度: 3)

**path(长度: 3)**

`4\n\n`

**data (长度: 0)**
| 字段 | 长度 | 类型 | 描述 |
| ---- | ---- | ---- | ---- |
| `-`  | 0    | void | 空   |

### 响应(长度: 11 = 3 + 8)

**path(长度: 3)**

`4\n\n`

**data (长度: 8)**

存在手动设置时, 才会返回气压数据

| 字段  | 长度 | 类型 | 描述    |
| ----- | ---- | ---- | ------- |
| `la1` | 1    | int  | 左1气囊 |
| `la2` | 1    | int  | 左2气囊 |
| `la3` | 1    | int  | 左3气囊 |
| `la4` | 1    | int  | 左4气囊 |
| `ra1` | 1    | int  | 右1气囊 |
| `ra2` | 1    | int  | 右2气囊 |
| `ra3` | 1    | int  | 右3气囊 |
| `ra4` | 1    | int  | 右4气囊 |

不存在手动设置时, 返回空数据

| 字段 | 长度 | 类型 | 描述 |
| ---- | ---- | ---- | ---- |
| `-`  | 0    | void | 空   |

